@using BlazorProject.Data

<MudDialog>
    <TitleContent>
        <MudText
            Typo="Typo.h5"
            Align="Align.Center"
        >
            Create Asset
        </MudText>
    </TitleContent>

    <DialogContent>
        <MudForm
            @ref="_form"
        >
            <MudTextField
                @bind-Value="Name"
                Label="Enter name"
                Required
                Immediate
            />
            
            <MudTextField
                @bind-Value="ISIN"
                Label="Enter ISIN"
            />
            
            <MudSelect
                Placeholder="Select type*"
                T="AssetType"
                @bind-Value="Type"
                Validation="@((AssetType value) => (int)value == 0 ? "Please specify the asset type" : null)"
            >
                @foreach (var type in Enum.GetValues<AssetType>()) {
                    <MudSelectItem
                        T="AssetType"
                        Value="@type"
                    />
                }
            </MudSelect>
        </MudForm>
    </DialogContent>

    <DialogActions>
        <MudButton OnClick="@(() => MudDialog.Cancel())">Cancel</MudButton>
        <MudButton
            ButtonType="ButtonType.Submit"
            Color="Color.Primary"
            OnClick="@( () => {
                         _form.Validate();

                         if (_form.IsValid) {
                             MudDialog.Close(DialogResult.Ok(new ReturnType(Name, ISIN, Type)));
                         }
                     })"
        >
            Submit
        </MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] private IMudDialogInstance MudDialog { get; set; } = null!;

    public record ReturnType(string Name, string ISIN, AssetType Type);

    public string Name { get; set; } = string.Empty;

    public string ISIN { get; set; } = string.Empty;

    private AssetType Type { get; set; }

    private MudForm _form = null!;
}